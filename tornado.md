---
title: tornado
date: 2018-06-22 16:08:08
tags:
---

## 一、异步和非阻塞I/O

实时web功能需要为每个用户提供一个多数时间被闲置的长连接，在传统的同步web服务器中，这意味着要为每个用户提供一个线程，当然每个线程的开销都是很昂贵的。

为了尽量减少并发连接造成的开销，Tornado使用了一种单线程事件循环的方式，这就意味着所有的应用代码都应该是异步非阻塞的，因为在同一时间只有一个操作是有效的。

### 1、阻塞

一个函数在等待某些事情的返回值的时候回被**阻塞**。函数被阻塞的原因有很多：网络I/O，磁盘I/O，互斥锁等。事实上，每个函数在运行和使用CPU的时候都或多或少会被阻塞（举个极端的例子来说明为什么对待CUP阻塞要和对待一般阻塞一样的严肃：比如密码哈希函数bcrypt，需要消耗几百毫秒的CPU时间，这已经远远超过了一般的网络或者磁盘请求时间了）。

一个函数可以在某些方面阻塞在另外一些方面不阻塞.例如,`tornado.httpclient`在默认的配置下,会在DNS解析上面阻塞,但是在其他网络请 求的时候不阻塞 (为了减轻这种影响，可以用`ThreadedResolver`或者是 通过正确配置`libcurl`用`tornado.curl_httpclient`来做). 在Tornado的上下文中,我们一般讨论网络I/O上下文的阻塞,尽管各种阻塞已经被最小化.

### 2、异步


